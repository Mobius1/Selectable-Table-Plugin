/*!
 *
 * Selectable Table Plugin
 * Copyright (c) 2018 Karl Saunders
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Plugin for https://github.com/Mobius1/Selectable that enables fast column and / or row selection / deselection.
 *
 * Add the '[data-selectable="column"]' attribute to the THEAD cells to enable column selection / deselection
 * Add the '[data-selectable="row"]' attribute to the first column cells to enable row selection / deselection
 * Add the '[data-selectable="all"]' to a cell to enable selection / deselection of all cells.
 *
 * Version: 0.0.3
 *
 */
window.Selectable&&"function"==typeof window.Selectable&&(Selectable.prototype.table=function(a){const b=this.version.split(".").map(c=>parseInt(c,10));if(1>b[0]&&14>b[1])return console.warn("The table plugin requires Selectable v0.14.0 and above.");if(void 0===a&&(a=this.get(0).node.closest("table")),a){const c=a.tHead.rows[0].cells,d=Array.from(a.tBodies[0].rows),f=g=>{const h=g.target.closest("td"),j=g.target.closest("th");let k=0;if(j&&"column"===j.dataset.selectable){for(let l=0;l<d.length;l++)this.get(d[l].cells[j.cellIndex]).selected&&k++;j.selected=k===d.length}else if(h&&"row"===h.dataset.selectable){for(let l=1;l<c.length;l++)this.get(h.parentNode.cells[l]).selected&&k++;h.selected=k==c.length-1}else if(j&&"all"===j.dataset.selectable){const l=this.getItems().length===this.getSelectedItems().length;j.selected=l,a.querySelectorAll("[data-selectable='row']").forEach(m=>m.selected=l),a.querySelectorAll("[data-selectable='column']").forEach(m=>m.selected=l)}};a.addEventListener("click",g=>{const h=g.target;if("TH"===h.nodeName||"TD"===h.nodeName){g.preventDefault();let j;if(a){const k=h.dataset;if("selectable"in k){if("all"===h.dataset.selectable)j=this.getItems();else if("TD"===h.nodeName&&"row"===k.selectable){const l=h.closest("tr");l&&(j=Array.from(l.cells))}else"TH"===h.nodeName&&"column"===k.selectable&&(j=Array.from(a.tBodies[0].rows).map(l=>{return l.cells[h.cellIndex]}));h.selected?(this.deselect(j),h.selected=!1):(this.select(j),h.selected=!0),f(g)}}}}),this.on("selectable.end",f)}});